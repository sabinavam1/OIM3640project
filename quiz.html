<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>CareerSpark</title>
  
</head>
<body>

<h1>CareerSpark</h1>

<div class="quiz-container" id="quiz">
  <div class="question" id="question"></div>
  <div class="options" id="options"></div>
  <button id="nextBtn" style="display:none;">Next</button>
</div>

<script>
let quizData = [];
let currentQuestion = 0;
const userAnswers = {};
const questionEl = document.getElementById('question');
const optionsEl = document.getElementById('options');
const nextBtn = document.getElementById('nextBtn');

// Fetch quiz data from a JSON or API endpoint
async function fetchQuizData() {
  try {
    const response = await fetch('quiz.json'); // or '/questions' if using an API
    quizData = await response.json();
    loadQuestion();
  } catch (error) {
    console.error('Failed to load quiz data:', error);
    questionEl.innerText = 'Failed to load questions.';
  }
}

function loadQuestion() {
  const currentQuiz = quizData[currentQuestion];
  questionEl.innerText = currentQuiz.question;
  optionsEl.innerHTML = '';
  nextBtn.style.display = 'none';

  currentQuiz.answers.forEach((option, index) => {
    const button = document.createElement('button');
    button.innerText = option.text;
    button.addEventListener('click', () => {
      userAnswers[currentQuiz.id] = index;
      Array.from(optionsEl.children).forEach(btn => btn.disabled = true);
      button.style.backgroundColor = '#005f99';
      nextBtn.style.display = 'block';
    });
    optionsEl.appendChild(button);
  });
}

nextBtn.addEventListener('click', () => {
  currentQuestion++;
  if (currentQuestion < quizData.length) {
    loadQuestion();
  } else {
    showResult();
  }
});

async function showResult() {
  try {
    const response = await fetch('/results', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ answers: userAnswers })
    });

    const result = await response.json();
    quiz.innerHTML = `
      <div class="result">${result.title}</div>
      <div class="summary">${result.summary}</div>
      <div class="summary"><strong>Suggested Jobs:</strong><br>${result.jobs.map(job => `- ${job}`).join('<br>')}</div>
      <button id="restartBtn">Retake Quiz</button>
    `;

    document.getElementById('restartBtn').addEventListener('click', () => location.reload());
  } catch (error) {
    console.error('Error calculating results:', error);
    quiz.innerHTML = '<div class="result">Error calculating results.</div>';
  }
}

fetchQuizData();
</script>

</body>
</html>
